FROM webdevops/php-nginx:alpine

WORKDIR /app

COPY . /app

ENV WEB_DOCUMENT_ROOT=/app/public
ENV WEB_DOCUMENT_INDEX=index.php
ENV PHP_DATE_TIMEZONE="Europe/Paris"
ENV PHP_MAX_EXECUTION_TIME=60
ENV PHP_DISPLAY_ERRORS=0
ENV APP_ENV=prod
ENV GOOGLE_CLIENT_ID=GOOGLE_CLIENT_ID
ENV GOOGLE_CLIENT_SECRET=GOOGLE_CLIENT_SECRET
ENV TWITTER_CONSUMER_KEY=TWITTER_CONSUMER_KEY
ENV TWITTER_CONSUMER_SECRET=TWITTER_CONSUMER_SECRET
ENV TWITTER_ACCESS_TOKEN=TWITTER_ACCESS_TOKEN
ENV TWITTER_ACCESS_TOKEN_SECRET=TWITTER_ACCESS_TOKEN_SECRET

RUN composer install --no-dev --prefer-dist --optimize-autoloader --no-interaction --no-progress

RUN rm -rf var/cache/*
RUN chown -R application. var/
