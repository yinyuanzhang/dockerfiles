FROM node:7-alpine
MAINTAINER Porawit Poboonma <ball6847@gmail.com>

ENV TERM=xterm-256colors

# Just a quick copy from parse-server repository
# @TODO: Customization
ENV PARSE_SERVER_VERSION="2.3.2" \
    PARSE_SERVER_APPLICATION_ID="myAppId" \
    PARSE_SERVER_MASTER_KEY="masterKey" \
    PARSE_SERVER_APP_NAME="myApp" \
    PARSE_SERVER_DATABASE_URI="mongodb://mongo:27017/db" \
    PARSE_SERVER_DATABASE_OPTIONS="" \
    PARSE_SERVER_HOST="0.0.0.0" \
    PORT="1337" \
    PARSE_SERVER_MOUNT_PATH="/parse" \
    PARSE_SERVER_URL="" \
    PARSE_PUBLIC_SERVER_URL="" \
    PARSE_SERVER_COLLECTION_PREFIX="" \
    PARSE_SERVER_CLIENT_KEY="" \
    PARSE_SERVER_JAVASCRIPT_KEY="" \
    PARSE_SERVER_REST_API_KEY="" \
    PARSE_SERVER_DOT_NET_KEY="" \
    PARSE_SERVER_WEBHOOK_KEY="" \
    PARSE_SERVER_CLOUD_CODE_MAIN="" \
    PARSE_SERVER_OAUTH_PROVIDERS="" \
    PARSE_SERVER_AUTH_PROVIDERS="" \
    PARSE_SERVER_PUSH="" \
    PARSE_SERVER_FILE_KEY="" \
    PARSE_SERVER_FACEBOOK_APP_IDS="" \
    PARSE_SERVER_ENABLE_ANON_USERS="" \
    PARSE_SERVER_ALLOW_CLIENT_CLASS_CREATION="" \
    PARSE_SERVER_FILES_ADAPTER="" \
    PARSE_SERVER_EMAIL_ADAPTER="" \
    PARSE_SERVER_VERIFY_USER_EMAILS="" \
    PARSE_SERVER_PREVENT_LOGIN_WITH_UNVERIFIED_EMAIL="" \
    PARSE_SERVER_EMAIL_VERIFY_TOKEN_VALIDITY_DURATION="" \
    PARSE_SERVER_ACCOUNT_LOCKOUT="" \
    PARSE_SERVER_PASSWORD_POLICY="" \
    PARSE_SERVER_LOGGER_ADAPTER="" \
    PARSE_SERVER_CUSTOM_PAGES="" \
    PARSE_SERVER_MAX_UPLOAD_SIZE="" \
    PARSE_SERVER_SESSION_LENGTH="" \
    VERBOSE="" \
    JSON_LOGS="" \
    PARSE_SERVER_LOG_LEVEL="" \
    PARSE_SERVER_LOGS_FOLDER="" \
    PARSE_SERVER_REVOKE_SESSION_ON_PASSWORD_RESET="" \
    PARSE_SERVER_SCHEMA_CACHE_TTL="" \
    PARSE_SERVER_ENABLE_SINGLE_SCHEMA_CACHE="" \
    PARSE_SERVER_CLUSTER="" \
    PARSE_SERVER_LIVE_QUERY_OPTIONS="" \
    PARSE_SERVER_LIVE_QUERY_CLASSNAMES="" \
    PARSE_SERVER_LIVE_QUERY_REDIS_URL=""

# For LiveQuery Server - You need to specify these variables

# PARSE_SERVER_LIVE_QUERY_CLASSNAMES (classes to allow livequery, in array format or comma separated eg. Project,Task)
# PARSE_SERVER_LIVE_QUERY_REDIS_URL (url to redis server eg. redis://redis:6379)

RUN npm install -g parse-server@2.3.2

ADD entrypoint.sh /entrypoint.sh

EXPOSE 1337

ENTRYPOINT [ "/entrypoint.sh" ]
